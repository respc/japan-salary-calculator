<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ï¼ˆé©æ ¼è«‹æ±‚æ›¸ç­‰ä¿å­˜æ–¹å¼ï¼‰ã®å½±éŸ¿ã‚’è¨ˆç®—ã€‚å…ç¨äº‹æ¥­è€…ãŒèª²ç¨äº‹æ¥­è€…ã«ãªã£ãŸå ´åˆã®è² æ‹…ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€‚">
    <title>ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦è¨ˆç®—æ©Ÿ | æ¶ˆè²»ç¨è² æ‹…ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .invoice-container { max-width: 900px; margin: 0 auto; }

        .status-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin: 24px 0;
        }

        .status-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .status-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .status-card.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #f5f7ff 0%, #e8ecff 100%);
        }

        .status-card .icon { font-size: 2.5rem; margin-bottom: 10px; }
        .status-card h4 { margin-bottom: 8px; color: #333; }
        .status-card p { font-size: 0.85rem; color: #666; }

        .result-section {
            background: white;
            border-radius: 16px;
            padding: 24px;
            margin: 24px 0;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .impact-card {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            border-radius: 16px;
            padding: 32px;
            color: white;
            text-align: center;
            margin: 24px 0;
        }

        .impact-card.positive {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
        }

        .impact-card.neutral {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .impact-amount {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 15px 0;
        }

        .timeline {
            margin: 24px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
        }

        .timeline-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 20px;
            padding-left: 30px;
            position: relative;
        }

        .timeline-item:before {
            content: '';
            position: absolute;
            left: 8px;
            top: 8px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #667eea;
        }

        .timeline-item:after {
            content: '';
            position: absolute;
            left: 13px;
            top: 24px;
            width: 2px;
            height: calc(100% + 8px);
            background: #e9ecef;
        }

        .timeline-item:last-child:after { display: none; }

        .timeline-date {
            min-width: 120px;
            font-weight: 600;
            color: #667eea;
        }

        .timeline-content {
            flex: 1;
        }

        .option-box {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            margin: 15px 0;
            transition: all 0.3s ease;
        }

        .option-box:hover {
            border-color: #667eea;
        }

        .option-box h4 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .option-box .tag {
            font-size: 0.75rem;
            padding: 3px 8px;
            border-radius: 4px;
            background: #e9ecef;
        }

        .option-box .tag.recommended {
            background: #d4edda;
            color: #155724;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .comparison-table th, .comparison-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }

        .comparison-table th {
            background: #667eea;
            color: white;
        }

        .comparison-table tr:hover {
            background: #f8f9fa;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px 20px;
            border-radius: 0 8px 8px 0;
            margin: 20px 0;
        }

        .chart-section {
            background: white;
            border-radius: 16px;
            padding: 24px;
            margin: 24px 0;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        @media (max-width: 768px) {
            .status-cards {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container invoice-container">
        <header>
            <h1>ğŸ“„ ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦è¨ˆç®—æ©Ÿ</h1>
            <p>å…ç¨äº‹æ¥­è€… â†’ èª²ç¨äº‹æ¥­è€…ã«ãªã£ãŸå ´åˆã®æ¶ˆè²»ç¨è² æ‹…ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</p>
            <a href="jigyounushi.html" style="display: inline-block; margin-top: 10px; padding: 8px 20px; background: rgba(255,255,255,0.2); color: white; text-decoration: none; border-radius: 20px; font-size: 0.9rem;">â† è¨ˆç®—ãƒ„ãƒ¼ãƒ«ã«æˆ»ã‚‹</a>
        </header>

        <!-- Status Selection -->
        <div class="result-section">
            <h3>ğŸ“‹ ã‚ãªãŸã®çŠ¶æ³ã‚’é¸æŠ</h3>
            <div class="status-cards">
                <div class="status-card selected" onclick="selectStatus('exempt')" id="status_exempt">
                    <div class="icon">ğŸ†“</div>
                    <h4>å…ç¨äº‹æ¥­è€…</h4>
                    <p>å¹´é–“å£²ä¸Š1,000ä¸‡å††ä»¥ä¸‹<br>æ¶ˆè²»ç¨ã‚’ç´ã‚ã¦ã„ãªã„</p>
                </div>
                <div class="status-card" onclick="selectStatus('taxable')" id="status_taxable">
                    <div class="icon">ğŸ’°</div>
                    <h4>èª²ç¨äº‹æ¥­è€…</h4>
                    <p>ã™ã§ã«æ¶ˆè²»ç¨ã‚’<br>ç´ã‚ã¦ã„ã‚‹</p>
                </div>
                <div class="status-card" onclick="selectStatus('considering')" id="status_considering">
                    <div class="icon">ğŸ¤”</div>
                    <h4>ç™»éŒ²æ¤œè¨ä¸­</h4>
                    <p>ã‚¤ãƒ³ãƒœã‚¤ã‚¹ç™»éŒ²ã‚’<br>æ¤œè¨ã—ã¦ã„ã‚‹</p>
                </div>
            </div>
        </div>

        <!-- Input Section -->
        <div class="result-section">
            <h3>ğŸ’¹ å£²ä¸Šãƒ»çµŒè²»æƒ…å ±</h3>
            <div class="input-row">
                <div class="input-group">
                    <label for="revenue">å¹´é–“å£²ä¸Šï¼ˆç¨æŠœï¼‰</label>
                    <div style="display: flex; align-items: center;">
                        <input type="text" id="revenue" value="600" placeholder="600">
                        <span class="unit">ä¸‡å††</span>
                    </div>
                </div>
                <div class="input-group">
                    <label for="expenses">å¹´é–“çµŒè²»ï¼ˆç¨æŠœï¼‰</label>
                    <div style="display: flex; align-items: center;">
                        <input type="text" id="expenses" value="100" placeholder="100">
                        <span class="unit">ä¸‡å††</span>
                    </div>
                </div>
            </div>

            <div class="input-row">
                <div class="input-group">
                    <label for="b2bRatio">å£²ä¸Šã®ã†ã¡B2Bï¼ˆæ³•äººå‘ã‘ï¼‰ã®å‰²åˆ</label>
                    <div style="display: flex; align-items: center;">
                        <input type="number" id="b2bRatio" value="80" min="0" max="100">
                        <span class="unit">%</span>
                    </div>
                    <small style="color: #666;">æ³•äººå‘ã‘å£²ä¸ŠãŒå¤šã„ã»ã©ã‚¤ãƒ³ãƒœã‚¤ã‚¹ç™»éŒ²ã®å½±éŸ¿å¤§</small>
                </div>
                <div class="input-group">
                    <label for="taxableExpenseRatio">çµŒè²»ã®ã†ã¡èª²ç¨ä»•å…¥ã®å‰²åˆ</label>
                    <div style="display: flex; align-items: center;">
                        <input type="number" id="taxableExpenseRatio" value="60" min="0" max="100">
                        <span class="unit">%</span>
                    </div>
                    <small style="color: #666;">æ¶ˆè²»ç¨ãŒã‹ã‹ã‚‹ä»•å…¥ãƒ»çµŒè²»ã®å‰²åˆ</small>
                </div>
            </div>

            <button class="calculate-btn" onclick="calculate()">å½±éŸ¿ã‚’è¨ˆç®—ã™ã‚‹</button>
        </div>

        <!-- Impact Card -->
        <div class="impact-card" id="impactCard">
            <h2 id="impactTitle">ã‚¤ãƒ³ãƒœã‚¤ã‚¹ç™»éŒ²ã—ãŸå ´åˆã®å¹´é–“è² æ‹…</h2>
            <div class="impact-amount" id="impactAmount">-</div>
            <p id="impactNote">æ¶ˆè²»ç¨ã®ç´ç¨ç¾©å‹™ãŒç™ºç”Ÿã—ã¾ã™</p>
        </div>

        <!-- Detailed Results -->
        <div class="result-section">
            <h3>ğŸ“Š è©³ç´°ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœ</h3>
            <table class="comparison-table">
                <tr>
                    <th>é …ç›®</th>
                    <th>å…ç¨äº‹æ¥­è€…ã®ã¾ã¾</th>
                    <th>ã‚¤ãƒ³ãƒœã‚¤ã‚¹ç™»éŒ²</th>
                </tr>
                <tr>
                    <td>å£²ä¸Šï¼ˆç¨è¾¼ï¼‰</td>
                    <td id="res_exempt_revenue">-</td>
                    <td id="res_taxable_revenue">-</td>
                </tr>
                <tr>
                    <td>é ã‹ã‚Šæ¶ˆè²»ç¨</td>
                    <td>ãªã—ï¼ˆç›Šç¨ï¼‰</td>
                    <td id="res_collected_tax">-</td>
                </tr>
                <tr>
                    <td>æ”¯æ‰•æ¶ˆè²»ç¨ï¼ˆä»•å…¥ç¨é¡æ§é™¤ï¼‰</td>
                    <td>-</td>
                    <td id="res_paid_tax">-</td>
                </tr>
                <tr>
                    <td>ç´ä»˜æ¶ˆè²»ç¨</td>
                    <td>0å††</td>
                    <td id="res_tax_payment">-</td>
                </tr>
                <tr>
                    <td>2å‰²ç‰¹ä¾‹é©ç”¨æ™‚</td>
                    <td>-</td>
                    <td id="res_special_tax">-</td>
                </tr>
                <tr style="background: #f8f9fa; font-weight: bold;">
                    <td>å®Ÿè³ªæ‰‹å–ã‚Šå¤‰åŒ–</td>
                    <td>åŸºæº–</td>
                    <td id="res_difference">-</td>
                </tr>
            </table>
        </div>

        <!-- Options -->
        <div class="result-section">
            <h3>ğŸ¯ ã‚ãªãŸã¸ã®é¸æŠè‚¢</h3>

            <div class="option-box" id="option1">
                <h4>
                    é¸æŠè‚¢1: ã‚¤ãƒ³ãƒœã‚¤ã‚¹ç™»éŒ²ã™ã‚‹
                    <span class="tag" id="option1_tag">å–å¼•å…ˆã«æ³•äººãŒå¤šã„å ´åˆ</span>
                </h4>
                <p id="option1_desc">å–å¼•å…ˆã‹ã‚‰å€¤å¼•ãè¦è«‹ã‚’é¿ã‘ã‚‰ã‚Œã‚‹ã€‚2å‰²ç‰¹ä¾‹ã‚’æ´»ç”¨ã™ã‚Œã°è² æ‹…ã‚’è»½æ¸›å¯èƒ½ã€‚</p>
                <ul>
                    <li>2å‰²ç‰¹ä¾‹: å£²ä¸Šç¨é¡ã®2å‰²ã®ã¿ç´ä»˜ï¼ˆ2026å¹´9æœˆã¾ã§ï¼‰</li>
                    <li>ç°¡æ˜“èª²ç¨: æ¥­ç¨®ã”ã¨ã®ã¿ãªã—ä»•å…¥ç‡ã§è¨ˆç®—ï¼ˆå±Šå‡ºå¿…è¦ï¼‰</li>
                </ul>
            </div>

            <div class="option-box" id="option2">
                <h4>
                    é¸æŠè‚¢2: å…ç¨äº‹æ¥­è€…ã®ã¾ã¾
                    <span class="tag" id="option2_tag">B2Cä¸­å¿ƒã®å ´åˆ</span>
                </h4>
                <p id="option2_desc">æ¶ˆè²»è€…å‘ã‘ï¼ˆB2Cï¼‰ãƒ“ã‚¸ãƒã‚¹ãªã‚‰å½±éŸ¿ã¯é™å®šçš„ã€‚ãŸã ã—æ³•äººå–å¼•ã§ä¸åˆ©ã«ãªã‚‹å¯èƒ½æ€§ã€‚</p>
                <ul>
                    <li>æ³•äººå–å¼•å…ˆã‹ã‚‰å–å¼•åœæ­¢ã‚„å€¤å¼•ãè¦è«‹ã®ãƒªã‚¹ã‚¯</li>
                    <li>2029å¹´10æœˆä»¥é™ã¯çµŒéæªç½®çµ‚äº†ã§å½±éŸ¿æ‹¡å¤§</li>
                </ul>
            </div>

            <div class="option-box" id="option3">
                <h4>
                    é¸æŠè‚¢3: å€¤å¼•ãã§å¯¾å¿œ
                    <span class="tag">äº¤æ¸‰æ¬¡ç¬¬</span>
                </h4>
                <p>å–å¼•å…ˆã¨äº¤æ¸‰ã—ã€æ¶ˆè²»ç¨ç›¸å½“åˆ†ã‚’å€¤å¼•ãã—ã¦å–å¼•ç¶™ç¶šã€‚</p>
                <ul>
                    <li>çµŒéæªç½®æœŸé–“ï¼ˆã€œ2029å¹´9æœˆï¼‰ã¯80%â†’50%æ§é™¤å¯èƒ½</li>
                    <li>å€¤å¼•ãå¹…ã¯å–å¼•å…ˆã¨ã®é–¢ä¿‚æ€§æ¬¡ç¬¬</li>
                </ul>
            </div>
        </div>

        <!-- Timeline -->
        <div class="result-section">
            <h3>ğŸ“… ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«</h3>
            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-date">2023å¹´10æœˆ</div>
                    <div class="timeline-content">
                        <strong>ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦é–‹å§‹</strong><br>
                        é©æ ¼è«‹æ±‚æ›¸ç™ºè¡Œäº‹æ¥­è€…ã®ç™»éŒ²é–‹å§‹
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-date">ã€œ2026å¹´9æœˆ</div>
                    <div class="timeline-content">
                        <strong>2å‰²ç‰¹ä¾‹æœŸé–“</strong><br>
                        å…ç¨äº‹æ¥­è€…ã‹ã‚‰ã®è»¢æ›è€…ã¯å£²ä¸Šç¨é¡ã®2å‰²ã®ã¿ç´ä»˜ã§OK
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-date">ã€œ2026å¹´9æœˆ</div>
                    <div class="timeline-content">
                        <strong>çµŒéæªç½®ï¼ˆ80%æ§é™¤ï¼‰</strong><br>
                        å…ç¨äº‹æ¥­è€…ã‹ã‚‰ã®ä»•å…¥ã§ã‚‚80%ã®ä»•å…¥ç¨é¡æ§é™¤ãŒå¯èƒ½
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-date">2026å¹´10æœˆã€œ</div>
                    <div class="timeline-content">
                        <strong>çµŒéæªç½®ï¼ˆ50%æ§é™¤ï¼‰</strong><br>
                        å…ç¨äº‹æ¥­è€…ã‹ã‚‰ã®ä»•å…¥ã¯50%ã®ã¿æ§é™¤å¯èƒ½
                    </div>
                </div>
                <div class="timeline-item">
                    <div class="timeline-date">2029å¹´10æœˆã€œ</div>
                    <div class="timeline-content">
                        <strong>çµŒéæªç½®çµ‚äº†</strong><br>
                        å…ç¨äº‹æ¥­è€…ã‹ã‚‰ã®ä»•å…¥ã¯ä»•å…¥ç¨é¡æ§é™¤ä¸å¯ã«
                    </div>
                </div>
            </div>
        </div>

        <!-- Chart -->
        <div class="chart-section">
            <h3>ğŸ“ˆ å£²ä¸Šåˆ¥ãƒ»æ¶ˆè²»ç¨è² æ‹…ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h3>
            <canvas id="taxChart" height="300"></canvas>
        </div>

        <!-- Warning -->
        <div class="warning-box">
            <strong>âš ï¸ æ³¨æ„äº‹é …</strong><br>
            <ul style="margin: 10px 0 0 20px;">
                <li>ã“ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯æ¦‚ç®—ã§ã™ã€‚å®Ÿéš›ã®ç¨é¡ã¯å–å¼•å†…å®¹ã«ã‚ˆã‚Šç•°ãªã‚Šã¾ã™</li>
                <li>ç°¡æ˜“èª²ç¨åˆ¶åº¦ã®é©ç”¨ã«ã¯äº‹å‰å±Šå‡ºãŒå¿…è¦ã§ã™</li>
                <li>å…·ä½“çš„ãªåˆ¤æ–­ã¯ç¨ç†å£«ã«ã”ç›¸è«‡ãã ã•ã„</li>
            </ul>
        </div>

        <div class="info-section">
            <h3>ğŸ“š ã‚¤ãƒ³ãƒœã‚¤ã‚¹åˆ¶åº¦ã¨ã¯ï¼Ÿ</h3>
            <ul>
                <li><strong>æ­£å¼åç§°:</strong> é©æ ¼è«‹æ±‚æ›¸ç­‰ä¿å­˜æ–¹å¼</li>
                <li><strong>ç›®çš„:</strong> æ¶ˆè²»ç¨ã®ä»•å…¥ç¨é¡æ§é™¤ã‚’æ­£ç¢ºã«è¡Œã†ãŸã‚ã®åˆ¶åº¦</li>
                <li><strong>å½±éŸ¿:</strong> ç™»éŒ²ã—ã¦ã„ãªã„äº‹æ¥­è€…ã‹ã‚‰ã®ä»•å…¥ã¯æ§é™¤ä¸å¯ã«</li>
                <li><strong>ç™»éŒ²:</strong> ç¨å‹™ç½²ã«ç”³è«‹ã—ã€Œé©æ ¼è«‹æ±‚æ›¸ç™ºè¡Œäº‹æ¥­è€…ã€ã«ãªã‚‹å¿…è¦ã‚ã‚Š</li>
            </ul>
        </div>
    </div>

    <script>
        let currentStatus = 'exempt';
        let chart = null;

        function selectStatus(status) {
            currentStatus = status;
            document.querySelectorAll('.status-card').forEach(card => {
                card.classList.remove('selected');
            });
            document.getElementById('status_' + status).classList.add('selected');
            calculate();
        }

        function parseNum(id) {
            const val = document.getElementById(id).value.replace(/,/g, '');
            return parseFloat(val) || 0;
        }

        function formatCurrency(amount) {
            return Math.round(amount).toLocaleString() + 'å††';
        }

        function calculate() {
            const revenue = parseNum('revenue') * 10000;
            const expenses = parseNum('expenses') * 10000;
            const b2bRatio = parseNum('b2bRatio') / 100;
            const taxableExpenseRatio = parseNum('taxableExpenseRatio') / 100;

            // Tax calculations
            const taxRate = 0.10;
            const revenueWithTax = revenue * (1 + taxRate);
            const collectedTax = revenue * taxRate;
            const paidTax = expenses * taxableExpenseRatio * taxRate;

            // Normal tax payment
            const normalTaxPayment = collectedTax - paidTax;

            // 2å‰²ç‰¹ä¾‹
            const specialTaxPayment = collectedTax * 0.2;

            // Best option
            const bestTaxPayment = Math.min(normalTaxPayment, specialTaxPayment);

            // Update results
            document.getElementById('res_exempt_revenue').textContent = formatCurrency(revenueWithTax);
            document.getElementById('res_taxable_revenue').textContent = formatCurrency(revenueWithTax);
            document.getElementById('res_collected_tax').textContent = formatCurrency(collectedTax);
            document.getElementById('res_paid_tax').textContent = '-' + formatCurrency(paidTax);
            document.getElementById('res_tax_payment').textContent = formatCurrency(normalTaxPayment);
            document.getElementById('res_special_tax').textContent = formatCurrency(specialTaxPayment) +
                (specialTaxPayment < normalTaxPayment ? ' âœ¨ãŠå¾—' : '');
            document.getElementById('res_difference').textContent = '-' + formatCurrency(bestTaxPayment);

            // Impact card
            const impactCard = document.getElementById('impactCard');
            if (bestTaxPayment > 0) {
                document.getElementById('impactTitle').textContent = 'ã‚¤ãƒ³ãƒœã‚¤ã‚¹ç™»éŒ²ã—ãŸå ´åˆã®å¹´é–“æ¶ˆè²»ç¨è² æ‹…';
                document.getElementById('impactAmount').textContent = formatCurrency(bestTaxPayment);
                document.getElementById('impactNote').textContent =
                    specialTaxPayment < normalTaxPayment
                        ? '2å‰²ç‰¹ä¾‹ã‚’ä½¿ãˆã°è² æ‹…ã‚’æŠ‘ãˆã‚‰ã‚Œã¾ã™'
                        : 'é€šå¸¸ã®è¨ˆç®—æ–¹æ³•ãŒæœ‰åˆ©ã§ã™';
                impactCard.className = 'impact-card';
            } else {
                document.getElementById('impactTitle').textContent = 'æ¶ˆè²»ç¨ã®é‚„ä»˜ãŒå—ã‘ã‚‰ã‚Œã‚‹å¯èƒ½æ€§';
                document.getElementById('impactAmount').textContent = formatCurrency(-bestTaxPayment);
                document.getElementById('impactNote').textContent = 'çµŒè²»ãŒå¤šã„å ´åˆã¯ç™»éŒ²ãƒ¡ãƒªãƒƒãƒˆã‚ã‚Š';
                impactCard.className = 'impact-card positive';
            }

            // Update options
            const option1Tag = document.getElementById('option1_tag');
            const option2Tag = document.getElementById('option2_tag');
            if (b2bRatio >= 0.7) {
                option1Tag.className = 'tag recommended';
                option1Tag.textContent = 'ãŠã™ã™ã‚';
                option2Tag.className = 'tag';
                option2Tag.textContent = 'ãƒªã‚¹ã‚¯ã‚ã‚Š';
            } else if (b2bRatio <= 0.3) {
                option1Tag.className = 'tag';
                option1Tag.textContent = 'è¦æ¤œè¨';
                option2Tag.className = 'tag recommended';
                option2Tag.textContent = 'ãŠã™ã™ã‚';
            } else {
                option1Tag.className = 'tag';
                option1Tag.textContent = 'çŠ¶æ³æ¬¡ç¬¬';
                option2Tag.className = 'tag';
                option2Tag.textContent = 'çŠ¶æ³æ¬¡ç¬¬';
            }

            // Update chart
            updateChart(expenses, taxableExpenseRatio);
        }

        function updateChart(expenses, taxableExpenseRatio) {
            const revenues = [300, 500, 700, 900, 1000, 1200, 1500];
            const normalData = [];
            const specialData = [];

            revenues.forEach(rev => {
                const revYen = rev * 10000;
                const taxRate = 0.10;
                const collectedTax = revYen * taxRate;
                const paidTax = expenses * taxableExpenseRatio * taxRate;

                normalData.push(Math.round((collectedTax - paidTax) / 10000));
                specialData.push(Math.round(collectedTax * 0.2 / 10000));
            });

            if (chart) {
                chart.destroy();
            }

            const ctx = document.getElementById('taxChart').getContext('2d');
            chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: revenues.map(r => r + 'ä¸‡å††'),
                    datasets: [
                        {
                            label: 'é€šå¸¸è¨ˆç®—',
                            data: normalData,
                            backgroundColor: 'rgba(102, 126, 234, 0.7)',
                            borderColor: '#667eea',
                            borderWidth: 1
                        },
                        {
                            label: '2å‰²ç‰¹ä¾‹',
                            data: specialData,
                            backgroundColor: 'rgba(39, 174, 96, 0.7)',
                            borderColor: '#27ae60',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'top' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.raw + 'ä¸‡å††';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'æ¶ˆè²»ç¨ç´ä»˜é¡ï¼ˆä¸‡å††ï¼‰' }
                        },
                        x: {
                            title: { display: true, text: 'å¹´é–“å£²ä¸Š' }
                        }
                    }
                }
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', calculate);
    </script>
</body>
</html>
