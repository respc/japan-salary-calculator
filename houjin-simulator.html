<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="å€‹äººäº‹æ¥­ä¸»ã‹ã‚‰æ³•äººåŒ–ï¼ˆæ³•äººæˆã‚Šï¼‰ã—ãŸå ´åˆã®ç¨é‡‘ãƒ»æ‰‹å–ã‚Šã‚’æ¯”è¼ƒã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€‚æ³•äººåŒ–ã®ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚’æ•°å€¤ã§ç¢ºèªã€‚">
    <title>æ³•äººæˆã‚Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ | å€‹äºº vs æ³•äºº æ¯”è¼ƒè¨ˆç®—</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .simulator-container { max-width: 1000px; margin: 0 auto; }

        .comparison-cards {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin: 24px 0;
        }

        .comparison-card {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .comparison-card.individual {
            border-top: 4px solid #667eea;
        }

        .comparison-card.corporation {
            border-top: 4px solid #27ae60;
        }

        .comparison-card h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .card-icon {
            font-size: 2rem;
        }

        .result-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
        }

        .result-row:last-child {
            border-bottom: none;
        }

        .result-row.total {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            margin: 10px -24px -24px -24px;
            padding: 16px 24px;
            border-radius: 0 0 16px 16px;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .result-row.total.better {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            color: #155724;
        }

        .verdict-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 32px;
            color: white;
            text-align: center;
            margin: 24px 0;
        }

        .verdict-card h2 {
            font-size: 1.8rem;
            margin-bottom: 15px;
        }

        .verdict-amount {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 15px 0;
        }

        .verdict-note {
            opacity: 0.9;
            font-size: 0.95rem;
        }

        .chart-container {
            background: white;
            border-radius: 16px;
            padding: 24px;
            margin: 24px 0;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .threshold-info {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px 20px;
            border-radius: 0 8px 8px 0;
            margin: 20px 0;
        }

        .pros-cons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 24px 0;
        }

        .pros, .cons {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        .pros { border-top: 3px solid #27ae60; }
        .cons { border-top: 3px solid #e74c3c; }

        .pros h4, .cons h4 {
            margin-bottom: 15px;
        }

        .pros li, .cons li {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }

        .input-section {
            background: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            margin-bottom: 24px;
        }

        .salary-slider {
            margin: 20px 0;
        }

        .salary-slider input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #e9ecef;
            outline: none;
            -webkit-appearance: none;
        }

        .salary-slider input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            color: #666;
            font-size: 0.85rem;
        }

        @media (max-width: 768px) {
            .comparison-cards, .pros-cons {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container simulator-container">
        <header>
            <h1>ğŸ¢ æ³•äººæˆã‚Šã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>
            <p>å€‹äººäº‹æ¥­ä¸» vs æ³•äººåŒ– - ã©ã¡ã‚‰ãŒæœ‰åˆ©ã‹æ•°å€¤ã§æ¯”è¼ƒ</p>
            <a href="jigyounushi.html" style="display: inline-block; margin-top: 10px; padding: 8px 20px; background: rgba(255,255,255,0.2); color: white; text-decoration: none; border-radius: 20px; font-size: 0.9rem;">â† è¨ˆç®—ãƒ„ãƒ¼ãƒ«ã«æˆ»ã‚‹</a>
        </header>

        <!-- Input Section -->
        <div class="input-section">
            <h3>ğŸ“Š ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ¡ä»¶</h3>

            <div class="input-row">
                <div class="input-group">
                    <label for="revenue">å¹´é–“å£²ä¸Šï¼ˆç¨æŠœï¼‰</label>
                    <div style="display: flex; align-items: center;">
                        <input type="text" id="revenue" value="1000" placeholder="1000">
                        <span class="unit">ä¸‡å††</span>
                    </div>
                </div>
                <div class="input-group">
                    <label for="expenses">å¹´é–“çµŒè²»ï¼ˆç¨æŠœï¼‰</label>
                    <div style="display: flex; align-items: center;">
                        <input type="text" id="expenses" value="200" placeholder="200">
                        <span class="unit">ä¸‡å††</span>
                    </div>
                </div>
            </div>

            <div class="input-row">
                <div class="input-group">
                    <label for="corpSalary">æ³•äººåŒ–å¾Œã®å½¹å“¡å ±é…¬ï¼ˆæœˆé¡ï¼‰</label>
                    <div style="display: flex; align-items: center;">
                        <input type="text" id="corpSalary" value="50" placeholder="50">
                        <span class="unit">ä¸‡å††</span>
                    </div>
                    <small style="color: #666;">æ³•äººã‹ã‚‰è‡ªåˆ†ã«æ”¯æ‰•ã†çµ¦æ–™</small>
                </div>
                <div class="input-group">
                    <label for="age">å¹´é½¢</label>
                    <div style="display: flex; align-items: center;">
                        <input type="number" id="age" value="35" min="20" max="70">
                        <span class="unit">æ­³</span>
                    </div>
                </div>
            </div>

            <div class="salary-slider">
                <label>å½¹å“¡å ±é…¬ã®èª¿æ•´: <strong id="salaryDisplay">50ä¸‡å††/æœˆ</strong></label>
                <input type="range" id="salarySlider" min="20" max="100" value="50" step="5">
                <div class="slider-labels">
                    <span>20ä¸‡å††</span>
                    <span>60ä¸‡å††</span>
                    <span>100ä¸‡å††</span>
                </div>
            </div>

            <button class="calculate-btn" onclick="calculate()">æ¯”è¼ƒè¨ˆç®—ã™ã‚‹</button>
        </div>

        <!-- Verdict -->
        <div class="verdict-card" id="verdictCard">
            <h2 id="verdictTitle">è¨ˆç®—çµæœ</h2>
            <div class="verdict-amount" id="verdictAmount">-</div>
            <p class="verdict-note" id="verdictNote">ä¸Šã®æ¡ä»¶ã‚’å…¥åŠ›ã—ã¦è¨ˆç®—ã—ã¦ãã ã•ã„</p>
        </div>

        <!-- Comparison Cards -->
        <div class="comparison-cards">
            <div class="comparison-card individual">
                <h3><span class="card-icon">ğŸ‘¤</span> å€‹äººäº‹æ¥­ä¸»ã®ã¾ã¾</h3>
                <div class="result-row">
                    <span>äº‹æ¥­æ‰€å¾—</span>
                    <span id="ind_income">-</span>
                </div>
                <div class="result-row">
                    <span>é’è‰²ç”³å‘Šæ§é™¤</span>
                    <span id="ind_aoiro">-65ä¸‡å††</span>
                </div>
                <div class="result-row">
                    <span>æ‰€å¾—ç¨</span>
                    <span id="ind_income_tax">-</span>
                </div>
                <div class="result-row">
                    <span>ä½æ°‘ç¨</span>
                    <span id="ind_resident_tax">-</span>
                </div>
                <div class="result-row">
                    <span>å›½æ°‘å¥åº·ä¿é™º</span>
                    <span id="ind_health">-</span>
                </div>
                <div class="result-row">
                    <span>å›½æ°‘å¹´é‡‘</span>
                    <span id="ind_pension">-</span>
                </div>
                <div class="result-row">
                    <span>å€‹äººäº‹æ¥­ç¨</span>
                    <span id="ind_business_tax">-</span>
                </div>
                <div class="result-row total" id="ind_total_row">
                    <span>æ‰‹å–ã‚Š</span>
                    <span id="ind_net">-</span>
                </div>
            </div>

            <div class="comparison-card corporation">
                <h3><span class="card-icon">ğŸ¢</span> æ³•äººåŒ–ã—ãŸå ´åˆ</h3>
                <div class="result-row">
                    <span>å½¹å“¡å ±é…¬ï¼ˆå¹´é¡ï¼‰</span>
                    <span id="corp_salary">-</span>
                </div>
                <div class="result-row">
                    <span>çµ¦ä¸æ‰€å¾—æ§é™¤</span>
                    <span id="corp_salary_deduction">-</span>
                </div>
                <div class="result-row">
                    <span>æ‰€å¾—ç¨ï¼ˆå€‹äººï¼‰</span>
                    <span id="corp_income_tax">-</span>
                </div>
                <div class="result-row">
                    <span>ä½æ°‘ç¨ï¼ˆå€‹äººï¼‰</span>
                    <span id="corp_resident_tax">-</span>
                </div>
                <div class="result-row">
                    <span>ç¤¾ä¼šä¿é™ºæ–™ï¼ˆå€‹äººè² æ‹…ï¼‰</span>
                    <span id="corp_social">-</span>
                </div>
                <div class="result-row">
                    <span>æ³•äººç¨ç­‰</span>
                    <span id="corp_corp_tax">-</span>
                </div>
                <div class="result-row">
                    <span>ç¤¾ä¼šä¿é™ºæ–™ï¼ˆä¼šç¤¾è² æ‹…ï¼‰</span>
                    <span id="corp_social_company">-</span>
                </div>
                <div class="result-row total" id="corp_total_row">
                    <span>å®Ÿè³ªæ‰‹å–ã‚Š</span>
                    <span id="corp_net">-</span>
                </div>
            </div>
        </div>

        <!-- Chart -->
        <div class="chart-container">
            <h3>ğŸ“ˆ å£²ä¸Šåˆ¥æ¯”è¼ƒã‚°ãƒ©ãƒ•</h3>
            <canvas id="comparisonChart" height="300"></canvas>
        </div>

        <!-- Threshold Info -->
        <div class="threshold-info" id="thresholdInfo">
            <strong>ğŸ’¡ æ³•äººåŒ–ã®ç›®å®‰:</strong><br>
            ä¸€èˆ¬çš„ã«äº‹æ¥­æ‰€å¾—ãŒ<strong>800ä¸‡å††ä»¥ä¸Š</strong>ã«ãªã‚‹ã¨æ³•äººåŒ–ã®ãƒ¡ãƒªãƒƒãƒˆãŒå‡ºå§‹ã‚ã¾ã™ã€‚
            ãŸã ã—ã€ç¤¾ä¼šä¿é™ºã®å……å®Ÿåº¦ã€ä¿¡ç”¨åŠ›ã€å°†æ¥ã®äº‹æ¥­å±•é–‹ãªã©ã‚‚è€ƒæ…®ã—ã¦ãã ã•ã„ã€‚
        </div>

        <!-- Pros and Cons -->
        <div class="pros-cons">
            <div class="pros">
                <h4>âœ… æ³•äººåŒ–ã®ãƒ¡ãƒªãƒƒãƒˆ</h4>
                <ul>
                    <li>å½¹å“¡å ±é…¬ã§çµ¦ä¸æ‰€å¾—æ§é™¤ãŒä½¿ãˆã‚‹</li>
                    <li>æ‰€å¾—ã®åˆ†æ•£ãŒå¯èƒ½ï¼ˆå®¶æ—ã‚’å½¹å“¡ã«ï¼‰</li>
                    <li>ç¤¾ä¼šä¿é™ºã§åšç”Ÿå¹´é‡‘ã«åŠ å…¥ã§ãã‚‹</li>
                    <li>æ³•äººç¨ç‡ãŒä¸€å®šï¼ˆæœ€å¤§23.2%ï¼‰</li>
                    <li>ä¿¡ç”¨åŠ›ãƒ»å–å¼•å…ˆã‹ã‚‰ã®ä¿¡é ¼å‘ä¸Š</li>
                    <li>çµŒè²»ã®å¹…ãŒåºƒãŒã‚‹ï¼ˆç¤¾å®…ã€å‡ºå¼µæ‰‹å½“ç­‰ï¼‰</li>
                    <li>é€€è·é‡‘ã‚’çµŒè²»ã«ã§ãã‚‹</li>
                    <li>èµ¤å­—ã®ç¹°è¶ŠãŒ10å¹´ï¼ˆå€‹äººã¯3å¹´ï¼‰</li>
                </ul>
            </div>
            <div class="cons">
                <h4>âŒ æ³•äººåŒ–ã®ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ</h4>
                <ul>
                    <li>è¨­ç«‹è²»ç”¨ãŒã‹ã‹ã‚‹ï¼ˆç´„25ä¸‡å††ï¼‰</li>
                    <li>ç¤¾ä¼šä¿é™ºæ–™ã®ä¼šç¤¾è² æ‹…ãŒå¤§ãã„</li>
                    <li>ç¨ç†å£«è²»ç”¨ãŒå¢—ãˆã‚‹ï¼ˆå¹´30ã€œ50ä¸‡å††ï¼‰</li>
                    <li>å½¹å“¡å ±é…¬ã¯åŸå‰‡å¹´1å›ã—ã‹å¤‰æ›´ä¸å¯</li>
                    <li>èµ¤å­—ã§ã‚‚æ³•äººä½æ°‘ç¨ã®å‡ç­‰å‰²ï¼ˆç´„7ä¸‡å††ï¼‰</li>
                    <li>ä¼šè¨ˆãƒ»æ±ºç®—ãŒè¤‡é›‘ã«ãªã‚‹</li>
                    <li>å»ƒæ¥­æ™‚ã®æ¸…ç®—æ‰‹ç¶šããŒé¢å€’</li>
                    <li>ãŠé‡‘ã‚’è‡ªç”±ã«å¼•ãå‡ºã›ãªã„</li>
                </ul>
            </div>
        </div>

        <div class="info-section">
            <h3>âš ï¸ æ³¨æ„äº‹é …</h3>
            <ul>
                <li>ã“ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯æ¦‚ç®—ã§ã™ã€‚å®Ÿéš›ã®ç¨é¡ã¯å„ç¨®æ§é™¤ã‚„æ¡ä»¶ã«ã‚ˆã‚Šç•°ãªã‚Šã¾ã™</li>
                <li>æ³•äººåŒ–ã®åˆ¤æ–­ã¯ç¨é‡‘ã ã‘ã§ãªãã€äº‹æ¥­ã®å°†æ¥æ€§ã‚„åƒãæ–¹ã‚‚è€ƒæ…®ã—ã¦ãã ã•ã„</li>
                <li>å…·ä½“çš„ãªæ¤œè¨ã¯ç¨ç†å£«ã«ã”ç›¸è«‡ãã ã•ã„</li>
            </ul>
        </div>
    </div>

    <script>
        let chart = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            const slider = document.getElementById('salarySlider');
            const corpSalaryInput = document.getElementById('corpSalary');
            const salaryDisplay = document.getElementById('salaryDisplay');

            slider.addEventListener('input', function() {
                corpSalaryInput.value = this.value;
                salaryDisplay.textContent = this.value + 'ä¸‡å††/æœˆ';
            });

            corpSalaryInput.addEventListener('change', function() {
                slider.value = this.value;
                salaryDisplay.textContent = this.value + 'ä¸‡å††/æœˆ';
            });

            calculate();
        });

        function parseNum(id) {
            const val = document.getElementById(id).value.replace(/,/g, '');
            return parseFloat(val) || 0;
        }

        function formatCurrency(amount) {
            return Math.round(amount).toLocaleString() + 'å††';
        }

        function formatMan(amount) {
            return (amount / 10000).toFixed(1) + 'ä¸‡å††';
        }

        // Individual calculation
        function calculateIndividual(revenue, expenses) {
            const income = (revenue - expenses) * 10000;
            const aoiroDeduction = 650000;
            const businessIncome = Math.max(0, income - aoiroDeduction);

            // Income tax
            const taxableIncome = Math.max(0, businessIncome - 480000); // Basic deduction
            const incomeTax = calculateIncomeTax(taxableIncome);

            // Resident tax
            const residentTax = Math.round(taxableIncome * 0.10 + 5000);

            // National health insurance
            const healthInsurance = Math.min(Math.round((businessIncome - 430000) * 0.11 + 45000), 1060000);

            // National pension
            const pension = 203760;

            // Business tax (for income over 2.9M)
            const businessTax = businessIncome > 2900000 ? Math.round((businessIncome - 2900000) * 0.05) : 0;

            const totalTax = incomeTax + residentTax + healthInsurance + pension + businessTax;
            const netIncome = income - totalTax;

            return {
                income,
                aoiroDeduction,
                businessIncome,
                incomeTax,
                residentTax,
                healthInsurance,
                pension,
                businessTax,
                totalTax,
                netIncome
            };
        }

        // Corporation calculation
        function calculateCorporation(revenue, expenses, monthlySalary, age) {
            const revenueYen = revenue * 10000;
            const expensesYen = expenses * 10000;
            const annualSalary = monthlySalary * 10000 * 12;

            // Salary deduction
            const salaryDeduction = calculateSalaryDeduction(annualSalary);
            const taxableSalary = Math.max(0, annualSalary - salaryDeduction - 480000);

            // Personal income tax
            const personalIncomeTax = calculateIncomeTax(taxableSalary);

            // Personal resident tax
            const personalResidentTax = Math.round(taxableSalary * 0.10 + 5000);

            // Social insurance (employee portion ~15%)
            const socialInsuranceEmployee = Math.round(annualSalary * 0.15);
            const socialInsuranceCompany = Math.round(annualSalary * 0.15);

            // Corporate profit
            const corporateExpenses = expensesYen + annualSalary + socialInsuranceCompany;
            const corporateProfit = Math.max(0, revenueYen - corporateExpenses);

            // Corporate tax (simplified: ~25% effective rate)
            let corpTaxRate = corporateProfit <= 8000000 ? 0.22 : 0.30;
            const corporateTax = Math.round(corporateProfit * corpTaxRate);

            // Net income after all taxes
            const totalPersonalTax = personalIncomeTax + personalResidentTax + socialInsuranceEmployee;
            const personalNetIncome = annualSalary - totalPersonalTax;

            // Add retained earnings (after corp tax) as potential value
            const retainedEarnings = corporateProfit - corporateTax;
            const effectiveNetIncome = personalNetIncome + retainedEarnings;

            return {
                annualSalary,
                salaryDeduction,
                personalIncomeTax,
                personalResidentTax,
                socialInsuranceEmployee,
                socialInsuranceCompany,
                corporateProfit,
                corporateTax,
                personalNetIncome,
                retainedEarnings,
                effectiveNetIncome,
                totalCost: totalPersonalTax + corporateTax + socialInsuranceCompany
            };
        }

        function calculateIncomeTax(taxableIncome) {
            if (taxableIncome <= 1950000) return Math.round(taxableIncome * 0.05);
            if (taxableIncome <= 3300000) return Math.round(taxableIncome * 0.10 - 97500);
            if (taxableIncome <= 6950000) return Math.round(taxableIncome * 0.20 - 427500);
            if (taxableIncome <= 9000000) return Math.round(taxableIncome * 0.23 - 636000);
            if (taxableIncome <= 18000000) return Math.round(taxableIncome * 0.33 - 1536000);
            if (taxableIncome <= 40000000) return Math.round(taxableIncome * 0.40 - 2796000);
            return Math.round(taxableIncome * 0.45 - 4796000);
        }

        function calculateSalaryDeduction(salary) {
            if (salary <= 1625000) return 550000;
            if (salary <= 1800000) return Math.round(salary * 0.40 - 100000);
            if (salary <= 3600000) return Math.round(salary * 0.30 + 80000);
            if (salary <= 6600000) return Math.round(salary * 0.20 + 440000);
            if (salary <= 8500000) return Math.round(salary * 0.10 + 1100000);
            return 1950000;
        }

        function calculate() {
            const revenue = parseNum('revenue');
            const expenses = parseNum('expenses');
            const corpSalary = parseNum('corpSalary');
            const age = parseNum('age');

            const ind = calculateIndividual(revenue, expenses);
            const corp = calculateCorporation(revenue, expenses, corpSalary, age);

            // Update individual results
            document.getElementById('ind_income').textContent = formatCurrency(ind.income);
            document.getElementById('ind_income_tax').textContent = formatCurrency(ind.incomeTax);
            document.getElementById('ind_resident_tax').textContent = formatCurrency(ind.residentTax);
            document.getElementById('ind_health').textContent = formatCurrency(ind.healthInsurance);
            document.getElementById('ind_pension').textContent = formatCurrency(ind.pension);
            document.getElementById('ind_business_tax').textContent = formatCurrency(ind.businessTax);
            document.getElementById('ind_net').textContent = formatCurrency(ind.netIncome);

            // Update corporation results
            document.getElementById('corp_salary').textContent = formatCurrency(corp.annualSalary);
            document.getElementById('corp_salary_deduction').textContent = '-' + formatCurrency(corp.salaryDeduction);
            document.getElementById('corp_income_tax').textContent = formatCurrency(corp.personalIncomeTax);
            document.getElementById('corp_resident_tax').textContent = formatCurrency(corp.personalResidentTax);
            document.getElementById('corp_social').textContent = formatCurrency(corp.socialInsuranceEmployee);
            document.getElementById('corp_corp_tax').textContent = formatCurrency(corp.corporateTax);
            document.getElementById('corp_social_company').textContent = formatCurrency(corp.socialInsuranceCompany);
            document.getElementById('corp_net').textContent = formatCurrency(corp.effectiveNetIncome);

            // Update verdict
            const difference = corp.effectiveNetIncome - ind.netIncome;
            const verdictCard = document.getElementById('verdictCard');
            const indRow = document.getElementById('ind_total_row');
            const corpRow = document.getElementById('corp_total_row');

            indRow.classList.remove('better');
            corpRow.classList.remove('better');

            if (difference > 0) {
                document.getElementById('verdictTitle').textContent = 'ğŸ¢ æ³•äººåŒ–ãŒæœ‰åˆ©ï¼';
                document.getElementById('verdictAmount').textContent = '+' + formatCurrency(difference) + '/å¹´';
                document.getElementById('verdictNote').textContent = 'æ³•äººåŒ–ã™ã‚‹ã“ã¨ã§å¹´é–“ ' + formatMan(difference) + ' ãŠå¾—ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™';
                verdictCard.style.background = 'linear-gradient(135deg, #27ae60 0%, #2ecc71 100%)';
                corpRow.classList.add('better');
            } else {
                document.getElementById('verdictTitle').textContent = 'ğŸ‘¤ å€‹äººäº‹æ¥­ä¸»ãŒæœ‰åˆ©ï¼';
                document.getElementById('verdictAmount').textContent = '+' + formatCurrency(-difference) + '/å¹´';
                document.getElementById('verdictNote').textContent = 'ç¾çŠ¶ç¶­æŒã§å¹´é–“ ' + formatMan(-difference) + ' ãŠå¾—ã§ã™';
                verdictCard.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
                indRow.classList.add('better');
            }

            // Update chart
            updateChart(expenses, corpSalary, age);
        }

        function updateChart(expenses, corpSalary, age) {
            const revenues = [400, 600, 800, 1000, 1200, 1500, 2000, 3000];
            const indData = [];
            const corpData = [];

            revenues.forEach(rev => {
                const ind = calculateIndividual(rev, expenses);
                const corp = calculateCorporation(rev, expenses, corpSalary, age);
                indData.push(Math.round(ind.netIncome / 10000));
                corpData.push(Math.round(corp.effectiveNetIncome / 10000));
            });

            if (chart) {
                chart.destroy();
            }

            const ctx = document.getElementById('comparisonChart').getContext('2d');
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: revenues.map(r => r + 'ä¸‡å††'),
                    datasets: [
                        {
                            label: 'å€‹äººäº‹æ¥­ä¸»',
                            data: indData,
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            fill: true,
                            tension: 0.4
                        },
                        {
                            label: 'æ³•äººåŒ–',
                            data: corpData,
                            borderColor: '#27ae60',
                            backgroundColor: 'rgba(39, 174, 96, 0.1)',
                            fill: true,
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'top' },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.raw + 'ä¸‡å††';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: { display: true, text: 'æ‰‹å–ã‚Šï¼ˆä¸‡å††ï¼‰' }
                        },
                        x: {
                            title: { display: true, text: 'å¹´é–“å£²ä¸Š' }
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
